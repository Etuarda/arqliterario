services:
  web:
    # Build da imagem a partir do Dockerfile
    build: .
    container_name: arqliterario_web

    # Exposição da aplicação
    ports:
      - "3000:3000"

    # Volumes
    volumes:
      # Código sincronizado para desenvolvimento
      - .:/app

      # Persistência do banco SQLite
      # Why: evita perder dados ao derrubar o container
      - sqlite_data:/app/db

    environment:
      # Ambiente explícito
      RAILS_ENV: development

    # Comando explícito (sobrepõe o CMD do Dockerfile)
    # Why: deixa o comportamento claro no compose
    command: bin/rails server -b 0.0.0.0

volumes:
  # Volume nomeado para persistir o SQLite
  sqlite_data:
    # Why: mantém os dados do banco mesmo se o container for removido
    driver: local